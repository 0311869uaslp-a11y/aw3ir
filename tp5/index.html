<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TP5 - Application M√©t√©o</title>
    
   
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/weather-icons.min.css">
    <style>
        .weather-card {
            transition: transform 0.3s ease;
        }
        .weather-card:hover {
            transform: translateY(-5px);
        }
        .city-item {
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .city-item:hover {
            background-color: #f8f9fa !important;
        }
        .map-container {
            border-bottom: 1px solid #dee2e6;
        }
    </style>
</head>
<body>
    <div id="weatherApp" class="container mt-4">
        
        <div class="row mb-4">
            <div class="col-12">
                <h1 class="text-center">üå§Ô∏è WebApp M√©t√©o avec Vuejs</h1>
                <p class="text-center text-muted">{{ message }}</p>
            </div>
        </div>
        
        <div class="row mb-4">
            <div class="col-md-6 mx-auto">
                <form v-on:submit="addCity">
                    <div class="input-group">
                        <input
                            type="search"
                            class="form-control"
                            v-model="formCityName"
                            placeholder="Entrez le nom d'une ville..."
                            aria-label="Search for..."
                            autofocus
                            required
                        />
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="submit">Go!</button>
                        </span>
                    </div>

                    
                    <small class="text-muted"> {{ formCityName.length }} caract√®res </small>

                 
                    <div class="alert alert-danger mt-2" role="alert" v-if='messageForm != ""'>
                        {{ messageForm }}
                    </div>
                </form>
            </div>
        </div>

        <div class="row">
          
            <div class="col-md-4">
                <h4>Liste des villes ({{ cityList.length }})</h4>
                
                <ul class="list-group">
                    <a
                        v-for="city in cityList"
                        v-on:click="meteo(city)"
                        class="list-group-item city-item d-flex justify-content-between align-items-center"
                    >
                        {{ city.name }}
                        <button
                            v-on:click.stop="remove(city)"
                            class="btn btn-danger btn-sm"
                            title="Supprimer de la liste"
                        >
                            &times;
                        </button>
                    </a>
                </ul>

                <div class="alert alert-info mt-3" role="alert" v-if="cityList.length == 0">
                    Aucune ville dans la liste!
                </div>
            </div>

            
            <div class="col-md-8">
            
                <div v-if="cityWeatherLoading" class="text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Chargement...</span>
                    </div>
                    <p class="mt-2">Chargement des donn√©es m√©t√©orologiques...</p>
                </div>

               
                <div v-if="cityWeather && !cityWeatherLoading">
                    <div class="card weather-card">
                        
                        <div class="card-header bg-primary text-white">
                            <h4 class="mb-0">{{ cityWeather.name }}, {{ cityWeather.sys.country }}</h4>
                        </div>
                        
                        
                        <div class="map-container">
                            <iframe
                                v-bind:src="'https://www.openstreetmap.org/export/embed.html?bbox=' + (cityWeather.coord.lon - 0.1) + '%2C' + (cityWeather.coord.lat - 0.1) + '%2C' + (cityWeather.coord.lon + 0.1) + '%2C' + (cityWeather.coord.lat + 0.1) + '&layer=mapnik&marker=' + cityWeather.coord.lat + '%2C' + cityWeather.coord.lon"
                                width="100%"
                                height="300"
                                style="border: none;"
                                frameborder="0"
                                scrolling="no"
                                marginheight="0"
                                marginwidth="0"
                                :title="'Carte de ' + cityWeather.name"
                            >
                            </iframe>
                        </div>

                        <div class="card-body text-center">
                            <h3 class="card-title">
                                <i v-bind:class="'wi wi-owm-' + cityWeather.weather[0].id"></i>
                                {{ Math.round(cityWeather.main.temp) }}¬∞C
                            </h3>
                            <p class="card-text h5 text-capitalize">{{ cityWeather.weather[0].description }}</p>
                            <p class="text-muted">Ressenti: {{ Math.round(cityWeather.main.feels_like) }}¬∞C</p>
                        </div>
                        
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <i class="wi wi-thermometer"></i> 
                                <strong>Temp√©rature:</strong> 
                                Min: {{ Math.round(cityWeather.main.temp_min) }}¬∞C - 
                                Max: {{ Math.round(cityWeather.main.temp_max) }}¬∞C
                            </li>
                            <li class="list-group-item">
                                <i class="wi wi-humidity"></i> 
                                <strong>Humidit√©:</strong> {{ cityWeather.main.humidity }}%
                            </li>
                            <li class="list-group-item">
                                <i class="wi wi-barometer"></i> 
                                <strong>Pression:</strong> {{ cityWeather.main.pressure }} hPa
                            </li>
                            <li class="list-group-item">
                                <i class="wi wi-cloud"></i> 
                                <strong>Nuages:</strong> {{ cityWeather.clouds.all }}%
                            </li>
                            <li class="list-group-item">
                                <i class="wi wi-strong-wind"></i> 
                                <strong>Vent:</strong> {{ Math.round(cityWeather.wind.speed * 3.6) }} km/h
                                <span v-if="cityWeather.wind.deg">
                                    ({{ getWindDirection(cityWeather.wind.deg) }})
                                </span>
                            </li>
                            <li class="list-group-item">
                                <i class="wi wi-sunrise"></i> 
                                <strong>Lever du soleil:</strong> {{ new Date(cityWeather.sys.sunrise * 1000).toLocaleTimeString() }}
                            </li>
                            <li class="list-group-item">
                                <i class="wi wi-sunset"></i> 
                                <strong>Coucher du soleil:</strong> {{ new Date(cityWeather.sys.sunset * 1000).toLocaleTimeString() }}
                            </li>
                        </ul>
                        
                        <div class="card-footer text-muted text-center">
                            <small>
                                <a 
                                    v-bind:href="'https://www.openstreetmap.org/?mlat=' + cityWeather.coord.lat + '&mlon=' + cityWeather.coord.lon + '#map=12/' + cityWeather.coord.lat + '/' + cityWeather.coord.lon"
                                    target="_blank"
                                    class="text-decoration-none"
                                >
                                    Voir la carte compl√®te sur OpenStreetMap
                                </a>
                                | Mis √† jour: {{ new Date().toLocaleString() }}
                            </small>
                        </div>
                    </div>
                </div>

               
                <div v-if="message && !cityWeatherLoading" class="alert alert-warning" role="alert">
                    {{ message }}
                </div>

                
                <div v-if="!cityWeather && !cityWeatherLoading && !message" class="text-center text-muted mt-5">
                    <i class="wi wi-day-sunny display-1"></i>
                    <h4 class="mt-3">S√©lectionnez une ville pour voir la m√©t√©o</h4>
                    <p>Cliquez sur n'importe quelle ville de la liste pour afficher ses informations m√©t√©orologiques</p>
                </div>
            </div>
        </div>
    </div>

  
    <script src="js/libs/vue.js"></script>
    <script src="js/libs/bootstrap.bundle.js"></script>
    <script src="js/main.js"></script>
</body>
</html>